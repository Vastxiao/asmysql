{"config":{"lang":["zh","en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"asmysql","text":"<ul> <li>PyPI: https://pypi.org/project/asmysql/</li> <li>GitHub: https://github.com/vastxiao/asmysql</li> <li>Gitee: https://gitee.com/vastxiao/asmysql</li> </ul>"},{"location":"#introduction","title":"Introduction","text":"<p>asmysql is a library for using the MySQL asynchronous client, which is a wrapper for aiomysql.</p>"},{"location":"#features","title":"Features","text":"<ul> <li>Code supports type annotations.</li> <li>Very easy to use, simply inherit the AsMysql class for logical development.</li> <li>Supports automatic management of the MySQL connection pool and reconnection mechanism.</li> <li>Automatically captures and handles MysqlError errors globally.</li> <li>Separates statement execution from data retrieval.</li> </ul>"},{"location":"#install","title":"Install","text":"<pre><code># Install from PyPI\npip install asmysql\n</code></pre>"},{"location":"#documentation","title":"Documentation","text":""},{"location":"#quick-start","title":"Quick Start","text":"<pre><code>import asyncio\nfrom asmysql import AsMysql\n\n\n# Directly inherit the AsMysql class for development:\nclass TestAsMysql(AsMysql):\n    # You can define some default parameters for the Mysql instance initialization here\n    # The attributes are consistent with the __init__ parameters\n    host = '127.0.0.1'\n    port = 3306\n    user = 'root'\n    password = 'pass'\n\n    async def get_users(self):\n        # The self.client attribute is specifically used to execute SQL statements, providing aiomysql's execute and execute_many methods.\n        result = await self.client.execute('select user,authentication_string,host from mysql.user')\n        # result is specifically used to obtain execution results, providing fetch_one, fetch_many, fetch_all, and iterate methods.\n        # result.err is the exception object (Exception) for all MySQL execution errors.\n        if result.err:\n            print(result.err_msg)\n        else:\n            # result.iterate() is an asynchronous iterator that can fetch each row of the execution result.\n            async for item in result.iterate():\n                print(item)\n\n\nasync def main():\n    # This will create an instance and connect to MySQL:\n    mysql = await TestAsMysql()\n\n    await mysql.get_users()\n\n    # Remember to disconnect the MySQL connection before exiting the program:\n    await mysql.disconnect()\n\n\nasyncio.run(main())\n</code></pre>"},{"location":"#support-for-asynchronous-context-managers","title":"Support for asynchronous context managers.","text":"<pre><code>import asyncio\nfrom asmysql import AsMysql\n\nclass TestAsMysql(AsMysql):\n    async def get_users(self):\n        result = await self.client.execute('select user,authentication_string,host from mysql.user')\n        if result.err:\n            print(result.err)\n        else:\n            async for item in result.iterate():\n                print(item)\n\nasync def main():\n    # Using async with will automatically close the MySQL connection when the code exits.\n    async with TestAsMysql() as mysql:\n        await mysql.get_users()\n\nif __name__ == '__main__':\n    asyncio.run(main())\n</code></pre>"},{"location":"#more-usage","title":"More Usage","text":"<pre><code>import asyncio\nfrom asmysql import AsMysql\n\nclass TestAsMysql(AsMysql):\n    async def get_users(self):\n        result = await self.client.execute('select user,authentication_string,host from mysql.user')\n        if result.err:\n            print(result.err)\n        else:\n            return await result.fetch_all()\n\n# When creating a MySQL instance, parameters such as MySQL address and user password can be passed in.\nmysql = TestAsMysql(host='192.168.1.192', port=3306)\n\nasync def main():\n    # This will connect to MySQL:\n    await mysql.connect()  # or: await mysql\n\n    print(await mysql.get_users())\n\n    # Disconnect MySQL connection:\n    await mysql.disconnect()\n\nasyncio.run(main())\n</code></pre>"},{"location":"CHANGELOG/","title":"Change Log","text":""},{"location":"CHANGELOG/#131-20250624","title":"[1.3.1] - 2025.06.24","text":"<ul> <li>Fix: Handle auto_commit using aiomysql's native attribute, support configuration passing.</li> </ul>"},{"location":"CHANGELOG/#130-20250621","title":"[1.3.0] - 2025.06.21","text":""},{"location":"CHANGELOG/#breaking-changes","title":"Breaking Changes","text":"<ul> <li>Changed Result.rowcount attribute to row_count</li> <li>Changed Result.lastrowid attribute to last_rowid</li> <li>Changed Result.rownumber attribute to row_number</li> </ul>"},{"location":"CHANGELOG/#120-20250620","title":"[1.2.0] - 2025.06.20","text":""},{"location":"CHANGELOG/#features","title":"Features","text":"<ul> <li>Expose <code>cursor</code> attribute in <code>Result</code>.</li> <li>Add new attributes <code>rowcount</code>, <code>lastrowid</code>, and <code>rownumber</code> to <code>Result</code>.</li> </ul>"},{"location":"CHANGELOG/#113-20250527","title":"[1.1.3] - 2025.05.27","text":""},{"location":"CHANGELOG/#features_1","title":"Features","text":"<pre><code>import asyncio\nfrom asmysql import AsMysql\n\nasync def main():\n    async with AsMysql() as mysql:\n        # execute method supports the commit parameter to control transaction submission, \n        # automatically determined by default.\n        await mysql.client.execute('insert into test(name) values(\"test\")', commit=False)\n\nasyncio.run(main())\n</code></pre>"},{"location":"CHANGELOG/#110-20250212","title":"[1.1.0] - 2025.02.12","text":""},{"location":"CHANGELOG/#features_2","title":"Features","text":"<pre><code>import asyncio\nfrom asmysql import AsMysql\n\nmysql = AsMysql()\n\nasync def main():\n    # AsMysql add function: async def __call__()\n    await mysql()\n\n    print(await mysql.client.execute('select user,host from mysql.user'))\n\n    # \u65ad\u5f00mysql\u8fde\u63a5\uff1a\n    await mysql.disconnect()\n\nasyncio.run(main())\n</code></pre>"},{"location":"CHANGELOG/#100-20241019","title":"[1.0.0] - 2024.10.19","text":""},{"location":"CHANGELOG/#features_3","title":"Features","text":"<ol> <li>Update the supported Python version range, with a minimum support of 3.9.</li> <li>Update the documentation content.</li> </ol>"},{"location":"CHANGELOG/#020-20241014","title":"[0.2.0] - 2024.10.14","text":""},{"location":"CHANGELOG/#features_4","title":"Features","text":"<ol> <li>Fixed the handling of the <code>echo</code> parameter in <code>aiomysql</code>.</li> <li>Added the <code>echo_sql_log</code> parameter to the <code>AsMysql</code> class, used to control whether <code>aiomysql</code> outputs the executed SQL statements (default is False).</li> </ol> <pre><code>from asmysql import AsMysql\n\nclass TestAsMysql(AsMysql):\n    # This allows controlling whether the executed SQL statements in aiomysql\n    # are output to Logging.logger.\n    echo_sql_log = True\n\n\n# Of course, the `echo_sql_log` parameter can also be passed when instantiating AsMysql.\nasync def main():\n    async with TestAsMysql(echo_sql_log=True) as mysql:\n        result = await mysql.client.execute('select user, authentication_string, host from mysql.user')\n        if result.err:\n            print(result.err)\n        else:\n            async for item in result.iterate():\n                print(item)\n</code></pre>"},{"location":"CHANGELOG/#014-20240815","title":"[0.1.4] - 2024.08.15","text":""},{"location":"CHANGELOG/#features_5","title":"Features","text":""},{"location":"CHANGELOG/#1-asmysql-supports-asynchronous-context-manager","title":"1. <code>AsMysql</code> supports asynchronous context manager.","text":"<pre><code>import asyncio\nfrom asmysql import AsMysql\n\nclass TestAsMysql(AsMysql):\n    async def get_users(self):\n        result = await self.client.execute('select user, authentication_string, host from mysql.user')\n        if result.err:\n            print(result.err)\n        else:\n            async for item in result.iterate():\n                print(item)\n\nasync def main():\n    async with TestAsMysql() as mysql:\n        await mysql.get_users()\n\nif __name__ == '__main__':\n    asyncio.run(main())\n</code></pre>"},{"location":"CHANGELOG/#2-replaced-exceptions-in-connection-with-connectionerror","title":"2. Replaced exceptions in <code>connection</code> with <code>ConnectionError</code>.","text":""},{"location":"CHANGELOG/#011-20230725","title":"[0.1.1] - 2023.07.25","text":""},{"location":"CHANGELOG/#features_6","title":"Features","text":"<p>Added <code>Result.err_msg</code> to return a detailed string of the exception error.</p>"},{"location":"CHANGELOG/#010-20230716","title":"[0.1.0] - 2023.07.16","text":""},{"location":"CHANGELOG/#breaking-changes_1","title":"Breaking Changes","text":""},{"location":"CHANGELOG/#features_7","title":"Features","text":"<ol> <li><code>asmysql</code> is a simplified wrapper library around <code>aiomysql</code>.</li> <li>Supports automatic management of MySQL connection pools and reconnection mechanism.</li> <li>Automatically captures and handles <code>MysqlError</code> globally.</li> <li>Separates statement execution and data retrieval.</li> <li>Directly integrates the <code>AsMysql</code> class for logical development.</li> </ol>"},{"location":"CHANGELOG/#internal","title":"Internal","text":"<p>Initialized the project, with the development environment managed using <code>poetry</code>.</p>"},{"location":"zh/#_1","title":"\u3010\u7b80\u4ecb\u3011","text":"<p>asmysql\u662f\u5c01\u88c5aiomysql\u7684mysql\u5f02\u6b65\u5ba2\u6237\u7aef\u4f7f\u7528\u5e93\u3002</p>"},{"location":"zh/#_2","title":"\u3010\u7279\u6027\u3011","text":"<ul> <li>\u4ee3\u7801\u652f\u6301\u7c7b\u578b\u6ce8\u91ca\u3002</li> <li>\u4f7f\u7528\u6781\u4e3a\u7b80\u5355\uff0c\u76f4\u63a5\u7ee7\u627fAsMysql\u7c7b\u8fdb\u884c\u903b\u8f91\u5f00\u53d1\u3002</li> <li>\u652f\u6301\u81ea\u52a8\u7ba1\u7406mysql\u8fde\u63a5\u6c60\uff0c\u548c\u91cd\u8fde\u673a\u5236\u3002</li> <li>\u5168\u5c40\u81ea\u52a8\u6355\u83b7\u5904\u7406MysqlError\u9519\u8bef\u3002</li> <li>\u5206\u79bb\u6267\u884c\u8bed\u53e5\u548c\u6570\u636e\u83b7\u53d6\u3002</li> </ul>"},{"location":"zh/#asmysql_1","title":"\u3010\u5b89\u88c5asmysql\u5305\u3011","text":"<pre><code># \u4ecePyPI\u5b89\u88c5\npip install asmysql\n</code></pre>"},{"location":"zh/#_3","title":"\u3010\u4f7f\u7528\u6587\u6863\u3011","text":""},{"location":"zh/#_4","title":"\u5feb\u901f\u5f00\u59cb","text":"<pre><code>import asyncio\nfrom asmysql import AsMysql\n\n\n# \u76f4\u63a5\u7ee7\u627fAsMysql\u7c7b\u8fdb\u884c\u5f00\u53d1:\nclass TestAsMysql(AsMysql):\n    # \u8fd9\u91cc\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e9bMysql\u5b9e\u4f8b\u521d\u59cb\u5316\u7684\u9ed8\u8ba4\u53c2\u6570\n    # \u5c5e\u6027\u8ddf __init__ \u53c2\u6570\u4e00\u81f4\n    host = '127.0.0.1'\n    port = 3306\n    user = 'root'\n    password = 'pass'\n\n    async def get_users(self):\n        # self.client\u5c5e\u6027\u662f\u4e13\u95e8\u7528\u6765\u6267\u884csql\u8bed\u53e5\u7684\uff0c\u63d0\u4f9baiomysql\u7684execute\u548cexecute_many\u65b9\u6cd5\n        result = await self.client.execute('select user,authentication_string,host from mysql.user')\n        # result\u662f\u4e13\u95e8\u7528\u6765\u83b7\u53d6\u6267\u884c\u7ed3\u679c\u7684\uff0c\u63d0\u4f9bfetch_one\u3001fetch_many\u3001fetch_all\u3001iterate\u65b9\u6cd5\n        # result.err\u662f\u6240\u6709\u5173\u4e8emysql\u6267\u884c\u7684\u5f02\u5e38\u5bf9\u8c61(Exception)\n        if result.err:\n            print(result.err_msg)\n        else:\n            # result.iterate()\u662f\u4e00\u4e2a\u5f02\u6b65\u8fed\u4ee3\u5668\uff0c\u53ef\u4ee5\u83b7\u53d6\u6267\u884c\u7ed3\u679c\u7684\u6bcf\u4e00\u884c\u6570\u636e\n            async for item in result.iterate():\n                print(item)\n\n\nasync def main():\n    # \u8fd9\u4e2a\u4f1a\u521b\u5efa\u5b9e\u4f8b\u5e76\u8fde\u63a5mysql\uff1a\n    mysql = await TestAsMysql()\n\n    await mysql.get_users()\n\n    # \u7a0b\u5e8f\u9000\u51fa\u524d\u8bb0\u5f97\u65ad\u5f00mysql\u8fde\u63a5\uff1a\n    await mysql.disconnect()\n\n\nasyncio.run(main())\n</code></pre>"},{"location":"zh/#_5","title":"\u652f\u6301\u5f02\u6b65\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u3002","text":"<pre><code>import asyncio\nfrom asmysql import AsMysql\n\nclass TestAsMysql(AsMysql):\n    async def get_users(self):\n        result = await self.client.execute('select user,authentication_string,host from mysql.user')\n        if result.err:\n            print(result.err)\n        else:\n            async for item in result.iterate():\n                print(item)\n\nasync def main():\n    # \u4f7f\u7528 async with \u7684\u8bdd\uff0c\u5728\u4ee3\u7801\u9000\u51fa\u65f6\u4f1a\u81ea\u52a8\u65ad\u5f00mysql\u8fde\u63a5\n    async with TestAsMysql() as mysql:\n        await mysql.get_users()\n\nif __name__ == '__main__':\n    asyncio.run(main())\n</code></pre>"},{"location":"zh/#_6","title":"\u521b\u5efa\u5b9e\u4f8b\u7684\u66f4\u591a\u7528\u6cd5","text":"<pre><code>import asyncio\nfrom asmysql import AsMysql\n\nclass TestAsMysql(AsMysql):\n    async def get_users(self):\n        result = await self.client.execute('select user,authentication_string,host from mysql.user')\n        if result.err:\n            print(result.err)\n        else:\n            return await result.fetch_all()\n\n# \u521b\u5efamysql\u5b9e\u4f8b\u65f6\u53ef\u4ee5\u4f20\u5165mysql\u5730\u5740\uff0c\u7528\u6237\u5bc6\u7801\u7b49\u53c2\u6570\nmysql = TestAsMysql(host='192.168.1.192', port=3306)\n\nasync def main():\n    # \u6267\u884c\u4f1a\u8fde\u63a5\u5230mysql\uff1a\n    await mysql.connect()  # or: await mysql\n\n    print(await mysql.get_users())\n\n    # \u65ad\u5f00mysql\u8fde\u63a5\uff1a\n    await mysql.disconnect()\n\nasyncio.run(main())\n</code></pre>"},{"location":"zh/CHANGELOG/#131-20250624","title":"[1.3.1] - 2025.06.24","text":"<ul> <li>Fix: auto_commit\u4f7f\u7528aiomysql\u539f\u751f\u5c5e\u6027\u5904\u7406\uff0c\u652f\u6301\u914d\u7f6e\u4f20\u5165\u3002</li> </ul>"},{"location":"zh/CHANGELOG/#breaking-changes","title":"Breaking Changes","text":"<ul> <li>\u4fee\u6539Result\u7684rowcount\u5c5e\u6027\u4e3arow_count</li> <li>\u4fee\u6539Result\u7684lastrowid\u5c5e\u6027\u4e3alast_rowid</li> <li>\u4fee\u6539Result\u7684rownumber\u5c5e\u6027\u4e3arow_number</li> </ul>"},{"location":"zh/CHANGELOG/#features","title":"Features","text":"<ul> <li>Result\u66b4\u9732cursor\u5c5e\u6027</li> <li>Result\u65b0\u589erowcount\u3001lastrowid\u3001rownumber\u5c5e\u6027</li> </ul>"},{"location":"zh/CHANGELOG/#features_1","title":"Features","text":"<pre><code>import asyncio\nfrom asmysql import AsMysql\n\nasync def main():\n    async with AsMysql() as mysql:\n        # execute\u65b9\u6cd5\u652f\u6301commit\u53c2\u6570\uff0c\u7528\u4e8e\u63a7\u5236\u662f\u5426\u63d0\u4ea4\u4e8b\u52a1\uff0c\u9ed8\u8ba4\u81ea\u52a8\u5224\u65ad\u3002\n        await mysql.client.execute('insert into test(name) values(\"test\")', commit=False)\n\nasyncio.run(main())\n</code></pre>"},{"location":"zh/CHANGELOG/#features_2","title":"Features","text":"<pre><code>import asyncio\nfrom asmysql import AsMysql\n\nmysql = AsMysql()\n\nasync def main():\n    # AsMysql\u65b0\u589e\u65b9\u6cd5: async def __call__()\n    await mysql()\n\n    print(await mysql.client.execute('select user,host from mysql.user'))\n\n    # \u65ad\u5f00mysql\u8fde\u63a5\uff1a\n    await mysql.disconnect()\n\nasyncio.run(main())\n</code></pre>"},{"location":"zh/CHANGELOG/#features_3","title":"Features","text":"<ol> <li>\u66f4\u65b0Python\u7248\u672c\u652f\u6301\u8303\u56f4\uff0c\u6700\u4f4e\u652f\u63013.9\u3002</li> <li>\u66f4\u65b0\u6587\u6863\u5185\u5bb9\u3002</li> </ol>"},{"location":"zh/CHANGELOG/#features_4","title":"Features","text":"<ol> <li>\u4fee\u590daiomysql\u5bf9echo\u53c2\u6570\u7684\u5904\u7406\u3002</li> <li>\u5bf9AsMysql\u7c7b\u65b0\u589eecho_sql_log\u53c2\u6570\uff0c\u7528\u4e8e\u63a7\u5236aiomysql\u662f\u5426\u8f93\u51fa\u6267\u884c\u7684sql\u8bed\u53e5(\u9ed8\u8ba4False)\u3002</li> </ol> <pre><code>from asmysql import AsMysql\n\nclass TestAsMysql(AsMysql):\n    # \u8fd9\u6837\u5c31\u53ef\u4ee5\u63a7\u5236aiomysql\u5e93\u662f\u5426\u5728Logging.logger\u8f93\u51fa\u6267\u884c\u7684sql\u8bed\u53e5\u3002\n    echo_sql_log = True\n\n\n# \u5f53\u7136\uff0cecho_sql_log\u53c2\u6570\u4e5f\u53ef\u4ee5\u5728\u5b9e\u4f8b\u5316AsMysql\u65f6\u4f20\u5165\u3002\nasync def main():\n    async with TestAsMysql(echo_sql_log=True) as mysql:\n        result = await mysql.client.execute('select user,authentication_string,host from mysql.user')\n        if result.err:\n            print(result.err)\n        else:\n            async for item in result.iterate():\n                print(item)\n</code></pre>"},{"location":"zh/CHANGELOG/#1asmysql","title":"1.AsMysql\u652f\u6301\u5f02\u6b65\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u3002","text":"<pre><code>import asyncio\nfrom asmysql import AsMysql\n\nclass TestAsMysql(AsMysql):\n    async def get_users(self):\n        result = await self.client.execute('select user,authentication_string,host from mysql.user')\n        if result.err:\n            print(result.err)\n        else:\n            async for item in result.iterate():\n                print(item)\n\nasync def main():\n    async with TestAsMysql() as mysql:\n        await mysql.get_users()\n\nif __name__ == '__main__':\n    asyncio.run(main())\n</code></pre>"},{"location":"zh/CHANGELOG/#2connectionconnectionerror","title":"2.\u5728connection\u4e2d\u7684\u5f02\u5e38\u629b\u51fa\u65f6\uff0c\u4f7f\u7528ConnectionError\u66ff\u4ee3\u3002","text":""},{"location":"zh/CHANGELOG/#features_6","title":"Features","text":"<p>\u65b0\u589e Result.err_msg \u8fd4\u56deexception\u9519\u8bef\u7684\u8be6\u60c5\u5b57\u7b26\u4e32\u3002</p>"},{"location":"zh/CHANGELOG/#features_7","title":"Features","text":"<ol> <li>asmysql\u662f\u5bf9aiomysql\u5c01\u88c5\u7684\u7b80\u6613\u4f7f\u7528\u5e93\u3002</li> <li>\u652f\u6301\u81ea\u52a8\u7ba1\u7406mysql\u8fde\u63a5\u6c60\uff0c\u548c\u91cd\u8fde\u673a\u5236\u3002</li> <li>\u5168\u5c40\u81ea\u52a8\u6355\u83b7\u5904\u7406MysqlError\u9519\u8bef\u3002</li> <li>\u5206\u79bb\u6267\u884c\u8bed\u53e5\u548c\u6570\u636e\u83b7\u53d6\u3002</li> <li>\u76f4\u63a5\u96c6\u6210AsMysql\u7c7b\u8fdb\u884c\u903b\u8f91\u5f00\u53d1\u3002</li> </ol>"},{"location":"zh/CHANGELOG/#internal","title":"Internal","text":"<p>\u521d\u59cb\u5316\u9879\u76ee\uff0c\u5f00\u53d1\u73af\u5883\u4f7f\u7528poetry\u8fdb\u884c\u7ba1\u7406\u3002</p>"}]}